# abline(h=0.5)
# for (i in 0:4){
#   abline(v=gut[nrow(gut)-i,1])
# }
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
ret_ind <- find_1_gt(db_year[,2])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,3), paste("(",round(gut_ub$y,3), ",", round(gut_lb$y,3), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
ret_ind <- find_1_gt(db_year[,2])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,4), paste("(",round(gut_ub$y,4), ",", round(gut_lb$y,4), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
ret_ind <- find_1_gt(db_year[,2])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,3],
xout = 0.5)
gut_ub <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,4],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,4), paste("(",round(gut_ub$y,4), ",", round(gut_lb$y,4), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
ret_ind <- find_1_gt(db_year[,2])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(ret_ind-1):ret_ind,3], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ret_ind-1):ret_ind,4], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,4), paste("(",round(gut_ub$y,4), ",", round(gut_lb$y,4), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
ret_ind <- find_1_gt(db_year[,2])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(ret_ind-1):ret_ind,3], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ret_ind-1):ret_ind,4], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,2), paste("(",round(gut_ub$y,2), ",", round(gut_lb$y,2), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
year_ind <- find_1_gt(db_year[,2])
lb_ind <- find_1_gt(db_year[,3])
ub_ind <- find_1_gt(db_year[,4])
gut_year <- approx(db_year[(ret_ind-1):ret_ind,2], db_year[(ret_ind-1):ret_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(lb_ind-1):lb_ind,3], db_year[(lb_ind-1):lb_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ub_ind-1):ub_ind,4], db_year[(ub_ind-1):ub_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,2), paste("(",round(gut_ub$y,2), ",", round(gut_lb$y,2), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
year_ind <- find_1_gt(db_year[,2])
lb_ind <- find_1_gt(db_year[,3])
ub_ind <- find_1_gt(db_year[,4])
gut_year <- approx(db_year[(year_ind-1):year_ind,2], db_year[(year_ind-1):year_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(lb_ind-1):lb_ind,3], db_year[(lb_ind-1):lb_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ub_ind-1):ub_ind,4], db_year[(ub_ind-1):ub_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,2), paste("(",round(gut_ub$y,2), ",", round(gut_lb$y,2), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval EVI")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut
gut_year <- data.frame(gut[,1])
col_names(gut_year) <- c("gut_raw")
View(gut_year)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = gut_raw - year)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw))
View(gut_year)
gut_year <- gut_year %>%
mutate(gut_val = gut_raw - year)
na.omit(gut_year)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw))
gut_year <- gut_year %>%
mutate(gut_val = gut_raw - year)
View(gut_year)
gut_year$gut_raw - gut_year$year
typeof(gut_year$gut_raw)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.float(gut_raw) - year)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
View(gut_year)
find_1_gt <- function(Y){
for (i in 2:length(Y)){
if ((Y[i] > 0.5) & (Y[i-1] < 0.5)){
index <- i
break
} else {
index <- length(Y)
}
}
return(index)
}
find_gut <- function(db){
gut <- c()
breaks <- c(1)
count <- 1
for (i in 2:nrow(db)){
if ((as.integer(db[i,1]) > as.integer(db[(i-1),1])) |
(i == nrow(db))){
db_year <- db[breaks[count]:(i-1),]
year_ind <- find_1_gt(db_year[,2])
lb_ind <- find_1_gt(db_year[,3])
ub_ind <- find_1_gt(db_year[,4])
gut_year <- approx(db_year[(year_ind-1):year_ind,2], db_year[(year_ind-1):year_ind,1],
xout = 0.5)
gut_lb <- approx(db_year[(lb_ind-1):lb_ind,3], db_year[(lb_ind-1):lb_ind,1],
xout = 0.5)
gut_ub <- approx(db_year[(ub_ind-1):ub_ind,4], db_year[(ub_ind-1):ub_ind,1],
xout = 0.5)
gut <- rbind(gut, c(round(gut_year$y,3), paste("(",round(gut_ub$y,3), ",", round(gut_lb$y,3), ")")))
breaks <- c(breaks, (i))
count <- count + 1
}
}
return(data.frame(gut))
}
model2 <- data.frame(cbind(X, q50[,2], q025[,2], q975[,2]))
colnames(model2) <- c("Year", "mu", "lb", "ub")
gut <- find_gut(model2)
colnames(gut) <- c("Time of GUT", "95% Interval")
plot(X[588:739],Y[588:739], xlab="Date", ylab="EVI")
lines(X[588:739],q50[588:739,2],col=2,lty=1)
lines(X[588:739],q025[588:739,2],col=2,lty=2)
lines(X[588:739],q975[588:739,2],col=2,lty=2)
abline(h=0.5)
for (i in 0:4){
abline(v=gut[nrow(gut)-i,1])
}
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
View(gut_year)
View(gut_year)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
data <- list(gut = gut_year$gut_val,year=gut$year,n=nrow(gut_year))
model_string <- textConnection("model{
# Likelihood
for(i in 1:n){
gut[i] ~ dnorm(beta1 + beta2*year[i],tau)
}
# Priors
tau   ~  dgamma(0.1, 0.1)
beta1 ~  dnorm(0, 0.001)
beta2 ~  dnorm(0, 0.001)
}")
inits <- list(beta1=rnorm(1),beta2=rnorm(1),tau=10)
model <- jags.model(model_string,data = data, inits=inits, n.chains=2,quiet=TRUE)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
data <- list(gut = gut_year$gut_val,year=gut$year,n=nrow(gut_year))
model_string <- textConnection("model{
# Likelihood
for(i in 1:n){
gut[i] ~ dnorm(beta1 + beta2*year[i],tau)
}
# Priors
tau   ~  dgamma(0.1, 0.1)
beta1 ~  dnorm(0, 0.001)
beta2 ~  dnorm(0, 0.001)
}")
model <- jags.model(model_string,data = data, inits=inits, n.chains=2,quiet=TRUE)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
data <- list(gut = gut_year$gut_val, year=gut_year$year,n=nrow(gut_year))
model_string <- textConnection("model{
# Likelihood
for(i in 1:n){
gut[i] ~ dnorm(beta1 + beta2*year[i],tau)
}
# Priors
tau   ~  dgamma(0.1, 0.1)
beta1 ~  dnorm(0, 0.001)
beta2 ~  dnorm(0, 0.001)
}")
model <- jags.model(model_string,data = data, inits=inits, n.chains=2,quiet=TRUE)
update(model, 10000, progress.bar="none")
params  <- c("beta1","beta2")
samples <- coda.samples(model,
variable.names=params,
n.iter=20000, progress.bar="none")
summary(samples)
gut_year <- data.frame(gut[,1])
colnames(gut_year) <- c("gut_raw")
gut_year <- na.omit(gut_year)
gut_year <- gut_year %>%
mutate(year = as.integer(gut_raw)) %>%
mutate(gut_val = as.numeric(gut_raw) - year)
data <- list(gut = gut_year$gut_val, year=gut_year$year,n=nrow(gut_year))
model_string <- textConnection("model{
# Likelihood
for(i in 1:n){
gut[i] ~ dnorm(beta1 + beta2*year[i],tau)
}
# Priors
tau   ~  dgamma(0.1, 0.1)
beta1 ~  dnorm(0, 0.001)
beta2 ~  dnorm(0, 0.001)
}")
model <- jags.model(model_string,data = data, inits=inits, n.chains=2,quiet=TRUE)
update(model, 10000, progress.bar="none")
params  <- c("beta1","beta2")
samples <- coda.samples(model,
variable.names=params,
n.iter=20000, progress.bar="none")
summary(samples)$quantiles
setwd("C:/Users/squar/Documents/hydraulic_ABM/Input Files/")
library(bnlearn)
abm <- read.bif("naive_wfh.bif")
View(abm)
graphviz.plot(abm)
View(abm)
summary(abm)
abm
rp <- read.bif("raw_rp_only.bif")
View(rp)
rp_all <- read.bif("full_rp.bif")
pmt <- read.bif("pmt_dag.bif")
View(pmt)
