db_x <- data.frame(lapply(db[,1:109], as.factor))
# df_x <- db_x[,c("risk_perception_r","Longitude_1","Friends_2","Trustingroups_7",
# "DemHealthcare","COVIDeffect_4","GenSocTrust","DemEdu","Personal_3",
# "DemGen","Trustingroups_11","Govresponse_7","Govresponse_8")]
db_y <- read.csv("prep_split.csv")
db_y <- data.frame(lapply(db_y[,1:13], as.factor))
colnames(db_y) <- c("Residency",
"Survey_round",
"hand_washing",
"hand_sanitizer",
"mask",
"avoid_social",
"avoid_transit",
"dine_out_less",
"touch_face_less",
"shop_groceries_less",
"cook_home_more",
"work_from_home",
"extra_supplies")
db_y <- subset(db_y, Survey_round == 1)
#### PMT 6 Models ####
# filter db_x so that only the PMT inputs remain.
df_x6 <- db_x[,c("risk_perception_r","Govresponse_7", "Longitude_1",
"Friends_2", "Personal_4", "Trustingroups_6", "Trustingroups_7",
"COVIDexp", "MediaExp_3", "KnowledgeCert_2", "MediaExp_1",
"Vaccine_1", "GenSocTrust", "DemHealthcare", "Trustingroups_2",
"Trustingroups_5", "KnowledgeCert_1", "Personal_7", "Soughtinfo",
"MediaExp_5", "COVIDeffect_3", "SARS", "Sciunderstand",
"FinitePool_6", "Friends_4", "Trustingroups_1", "DemEdu",
"COVIDeffect_4", "Survey_round")]
# add pm variables to df_6 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_6 <- cbind(df_x6, df_y)
df_6 <- cleaning(df_6, threshold=0.12)
df_x2 <- db_x[,c("risk_perception_r", "COVIDexp", "SARS", "Trustingroups_7",
"KnowledgeCert_1", "Trustingroups_6", "Friends_1",
"Trustingroups_12", "MediaExp_1", "FinitePool_6", "MediaExp_7",
"MediaExp_4", "Friends_4", "COVIDeffect_4",
"Govresponse_7", "Survey_round", "CanadaQ_1_7")]
# add pm variables to df_2 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_2 <- cbind(df_x2, df_y)
df_2 <- cleaning(df_2, threshold=0.12)
#### Calculate PMT 6 and 2 performance of each model ####
# wfh performance
calc_single_perf('work_from_home', 6, df_6)
calc_single_perf('work_from_home', 2, df_2)
# dine performance
calc_single_perf('dine_out_less', 6, df_6)
calc_single_perf('dine_out_less', 2, df_2)
# grocery performance
calc_single_perf('shop_groceries_less', 6, df_6)
calc_single_perf('shop_groceries_less', 2, df_2)
# ppe performance
calc_single_perf('mask', 6, df_6)
calc_single_perf('mask', 2, df_2)
#### clear the environment ####
rm(list = ls())
cat("\014")
library(bnlearn)
library(openxlsx)
setwd("C:/Users/squar/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
# setwd("~/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
source(file = '../../BBN/country_breakdown/functions.R')
source(file = '../../BBN/country_breakdown/package_installation.R')
calc_single_perf <- function(class_var, pmt, df_tot){
if (pmt == 6){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Longitude_1|risk_perception_r][Friends_2|risk_perception_r]",
"[Personal_4|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Trustingroups_7|risk_perception_r][COVIDexp|risk_perception_r]",
"[MediaExp_3|risk_perception_r][KnowledgeCert_2|risk_perception_r]",
"[MediaExp_1|risk_perception_r][Vaccine_1|risk_perception_r]",
"[GenSocTrust|risk_perception_r][DemHealthcare|risk_perception_r]",
"[Trustingroups_2|risk_perception_r][Trustingroups_5|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Personal_7|risk_perception_r]",
"[Soughtinfo|risk_perception_r][MediaExp_5|risk_perception_r]",
"[COVIDeffect_3|risk_perception_r][SARS|risk_perception_r]",
"[Sciunderstand|risk_perception_r][FinitePool_6|risk_perception_r]",
"[Friends_4|risk_perception_r][Trustingroups_1|risk_perception_r]",
"[DemEdu|risk_perception_r][COVIDeffect_4|risk_perception_r]",
"[Govresponse_7|", class_var, "]", "[Govresponse_8|", class_var, "]"))
} else if (pmt == 2){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Govresponse_7|", class_var, "]", "[Govresponse_7|", class_var, "]",
"[CanadaQ_1_7|", class_var, "][COVIDexp|risk_perception_r]",
"[SARS|risk_perception_r][Trustingroups_7|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Friends_1|risk_perception_r][Trustingroups_12|risk_perception_r]",
"[MediaExp_1|risk_perception_r][FinitePool_6|risk_perception_r]",
"[MediaExp_7|risk_perception_r][MediaExp_4|risk_perception_r]",
"[Friends_4|risk_perception_r][COVIDeffect_4|risk_perception_r]"))
}
all_pms <- c('work_from_home', 'dine_out_less', 'shop_groceries_less', 'mask')
pms <- all_pms[!all_pms == class_var]
df_func <- df_tot[,!names(df_tot) %in% pms]
class_level <- '2'
seed <- 218
# print(summary(df_func[class_var]))
# data_tt <- train_test(df_func, target=class_var, train_size=0.7, seed=seed)
cv_list <- cv_partition(df_func, target=class_var, runs=10, k=10, seeds=seed)
# print(cv_list)
# struc_str = paste0("list(model = naive.bayes, args = list(x = train, training = ", "'", class_var, "'))")
# classifier_function = function(t,...) bbn_learning(t, ...)$prediction_fun
bbn_learned <- function(data, target){
fitted = bn.fit(dag, data, method="bayes")
output_fun <- function(data){
# input args of prediction model
args_list <- list(fitted, data=data, node=target, method="bayes-lw", n=100, prob=T)
do.call(predict, args = args_list)
}
return(list(prediction_fun = output_fun, model = fitted))
}
classifier_function <- function(data, ...) bbn_learned(data, ...)$prediction_fun
print(colMeans(cv_evaluation(df_func,
cv_list,
performance_fun = performance_fun,
class_variable = class_var,
class_level = class_level,
classifier_function = classifier_function,
target = class_var)$validation))
# output the current fitted dag in .bif format
write.bif(paste0("./pmt_models/", class_var, "_pmt-", pmt, ".bif"), bbn_learned(df_func, class_var)$model)
# predictive_model <- function(data){
#   prediction <-  attr(learned_model(data),'prob')[class_level,]
# }
#
# print(performance_fun(df_func, predictive_model,
#                       class_variable = class_var,
#                       class_level = class_level))
}
# Read dataset -------------
db <- read.xlsx('data_file_reduced.xlsx')
# remove descriptive rows
db <- db[-c(1:3),]
db <- subset(db, Survey_round == 1)
# predictors
db_x <- data.frame(lapply(db[,1:109], as.factor))
# df_x <- db_x[,c("risk_perception_r","Longitude_1","Friends_2","Trustingroups_7",
# "DemHealthcare","COVIDeffect_4","GenSocTrust","DemEdu","Personal_3",
# "DemGen","Trustingroups_11","Govresponse_7","Govresponse_8")]
db_y <- read.csv("prep_split.csv")
db_y <- data.frame(lapply(db_y[,1:13], as.factor))
colnames(db_y) <- c("Residency",
"Survey_round",
"hand_washing",
"hand_sanitizer",
"mask",
"avoid_social",
"avoid_transit",
"dine_out_less",
"touch_face_less",
"shop_groceries_less",
"cook_home_more",
"work_from_home",
"extra_supplies")
db_y <- subset(db_y, Survey_round == 1)
#### PMT 6 Models ####
# filter db_x so that only the PMT inputs remain.
df_x6 <- db_x[,c("risk_perception_r","Govresponse_7", "Longitude_1",
"Friends_2", "Personal_4", "Trustingroups_6", "Trustingroups_7",
"COVIDexp", "MediaExp_3", "KnowledgeCert_2", "MediaExp_1",
"Vaccine_1", "GenSocTrust", "DemHealthcare", "Trustingroups_2",
"Trustingroups_5", "KnowledgeCert_1", "Personal_7", "Soughtinfo",
"MediaExp_5", "COVIDeffect_3", "SARS", "Sciunderstand",
"FinitePool_6", "Friends_4", "Trustingroups_1", "DemEdu",
"COVIDeffect_4", "Survey_round")]
# add pm variables to df_6 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_6 <- cbind(df_x6, df_y)
df_6 <- cleaning(df_6, threshold=0.12)
df_x2 <- db_x[,c("risk_perception_r", "COVIDexp", "SARS", "Trustingroups_7",
"KnowledgeCert_1", "Trustingroups_6", "Friends_1",
"Trustingroups_12", "MediaExp_1", "FinitePool_6", "MediaExp_7",
"MediaExp_4", "Friends_4", "COVIDeffect_4", "Govresponse_8",
"Govresponse_7", "Survey_round", "CanadaQ_1_7")]
# add pm variables to df_2 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_2 <- cbind(df_x2, df_y)
df_2 <- cleaning(df_2, threshold=0.12)
#### Calculate PMT 6 and 2 performance of each model ####
# wfh performance
calc_single_perf('work_from_home', 6, df_6)
calc_single_perf('work_from_home', 2, df_2)
# dine performance
calc_single_perf('dine_out_less', 6, df_6)
calc_single_perf('dine_out_less', 2, df_2)
# grocery performance
calc_single_perf('shop_groceries_less', 6, df_6)
calc_single_perf('shop_groceries_less', 2, df_2)
# ppe performance
calc_single_perf('mask', 6, df_6)
calc_single_perf('mask', 2, df_2)
#### clear the environment ####
rm(list = ls())
cat("\014")
library(bnlearn)
library(openxlsx)
setwd("C:/Users/squar/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
# setwd("~/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
source(file = '../../BBN/country_breakdown/functions.R')
source(file = '../../BBN/country_breakdown/package_installation.R')
calc_single_perf <- function(class_var, pmt, df_tot){
if (pmt == 6){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Longitude_1|risk_perception_r][Friends_2|risk_perception_r]",
"[Personal_4|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Trustingroups_7|risk_perception_r][COVIDexp|risk_perception_r]",
"[MediaExp_3|risk_perception_r][KnowledgeCert_2|risk_perception_r]",
"[MediaExp_1|risk_perception_r][Vaccine_1|risk_perception_r]",
"[GenSocTrust|risk_perception_r][DemHealthcare|risk_perception_r]",
"[Trustingroups_2|risk_perception_r][Trustingroups_5|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Personal_7|risk_perception_r]",
"[Soughtinfo|risk_perception_r][MediaExp_5|risk_perception_r]",
"[COVIDeffect_3|risk_perception_r][SARS|risk_perception_r]",
"[Sciunderstand|risk_perception_r][FinitePool_6|risk_perception_r]",
"[Friends_4|risk_perception_r][Trustingroups_1|risk_perception_r]",
"[DemEdu|risk_perception_r][COVIDeffect_4|risk_perception_r]",
"[Govresponse_7|", class_var, "]", "[Govresponse_8|", class_var, "]"))
} else if (pmt == 2){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Govresponse_7|", class_var, "]", "[Govresponse_7|", class_var, "]",
"[CanadaQ_1_7|", class_var, "][COVIDexp|risk_perception_r]",
"[SARS|risk_perception_r][Trustingroups_7|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Friends_1|risk_perception_r][Trustingroups_12|risk_perception_r]",
"[MediaExp_1|risk_perception_r][FinitePool_6|risk_perception_r]",
"[MediaExp_7|risk_perception_r][MediaExp_4|risk_perception_r]",
"[Friends_4|risk_perception_r][COVIDeffect_4|risk_perception_r]"))
}
all_pms <- c('work_from_home', 'dine_out_less', 'shop_groceries_less', 'mask')
pms <- all_pms[!all_pms == class_var]
df_func <- df_tot[,!names(df_tot) %in% pms]
class_level <- '2'
seed <- 218
# print(summary(df_func[class_var]))
# data_tt <- train_test(df_func, target=class_var, train_size=0.7, seed=seed)
cv_list <- cv_partition(df_func, target=class_var, runs=10, k=10, seeds=seed)
# print(cv_list)
# struc_str = paste0("list(model = naive.bayes, args = list(x = train, training = ", "'", class_var, "'))")
# classifier_function = function(t,...) bbn_learning(t, ...)$prediction_fun
bbn_learned <- function(data, target){
fitted = bn.fit(dag, data, method="bayes")
output_fun <- function(data){
# input args of prediction model
args_list <- list(fitted, data=data, node=target, method="bayes-lw", n=100, prob=T)
do.call(predict, args = args_list)
}
return(list(prediction_fun = output_fun, model = fitted))
}
classifier_function <- function(data, ...) bbn_learned(data, ...)$prediction_fun
print(colMeans(cv_evaluation(df_func,
cv_list,
performance_fun = performance_fun,
class_variable = class_var,
class_level = class_level,
classifier_function = classifier_function,
target = class_var)$validation))
# output the current fitted dag in .bif format
write.bif(paste0("./pmt_models/", class_var, "_pmt-", pmt, ".bif"), bbn_learned(df_func, class_var)$model)
# predictive_model <- function(data){
#   prediction <-  attr(learned_model(data),'prob')[class_level,]
# }
#
# print(performance_fun(df_func, predictive_model,
#                       class_variable = class_var,
#                       class_level = class_level))
}
# Read dataset -------------
db <- read.xlsx('data_file_reduced.xlsx')
# remove descriptive rows
db <- db[-c(1:3),]
db <- subset(db, Survey_round == 1)
# predictors
db_x <- data.frame(lapply(db[,1:109], as.factor))
# df_x <- db_x[,c("risk_perception_r","Longitude_1","Friends_2","Trustingroups_7",
# "DemHealthcare","COVIDeffect_4","GenSocTrust","DemEdu","Personal_3",
# "DemGen","Trustingroups_11","Govresponse_7","Govresponse_8")]
db_y <- read.csv("prep_split.csv")
db_y <- data.frame(lapply(db_y[,1:13], as.factor))
colnames(db_y) <- c("Residency",
"Survey_round",
"hand_washing",
"hand_sanitizer",
"mask",
"avoid_social",
"avoid_transit",
"dine_out_less",
"touch_face_less",
"shop_groceries_less",
"cook_home_more",
"work_from_home",
"extra_supplies")
db_y <- subset(db_y, Survey_round == 1)
#### PMT 6 Models ####
# filter db_x so that only the PMT inputs remain.
df_x6 <- db_x[,c("risk_perception_r","Govresponse_7", "Govresponse_8", "Longitude_1",
"Friends_2", "Personal_4", "Trustingroups_6", "Trustingroups_7",
"COVIDexp", "MediaExp_3", "KnowledgeCert_2", "MediaExp_1",
"Vaccine_1", "GenSocTrust", "DemHealthcare", "Trustingroups_2",
"Trustingroups_5", "KnowledgeCert_1", "Personal_7", "Soughtinfo",
"MediaExp_5", "COVIDeffect_3", "SARS", "Sciunderstand",
"FinitePool_6", "Friends_4", "Trustingroups_1", "DemEdu",
"COVIDeffect_4", "Survey_round")]
# add pm variables to df_6 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_6 <- cbind(df_x6, df_y)
df_6 <- cleaning(df_6, threshold=0.12)
df_x2 <- db_x[,c("risk_perception_r", "COVIDexp", "SARS", "Trustingroups_7",
"KnowledgeCert_1", "Trustingroups_6", "Friends_1",
"Trustingroups_12", "MediaExp_1", "FinitePool_6", "MediaExp_7",
"MediaExp_4", "Friends_4", "COVIDeffect_4", "Govresponse_8",
"Govresponse_7", "Survey_round", "CanadaQ_1_7")]
# add pm variables to df_2 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_2 <- cbind(df_x2, df_y)
df_2 <- cleaning(df_2, threshold=0.12)
#### Calculate PMT 6 and 2 performance of each model ####
# wfh performance
calc_single_perf('work_from_home', 6, df_6)
calc_single_perf('work_from_home', 2, df_2)
# dine performance
calc_single_perf('dine_out_less', 6, df_6)
calc_single_perf('dine_out_less', 2, df_2)
# grocery performance
calc_single_perf('shop_groceries_less', 6, df_6)
calc_single_perf('shop_groceries_less', 2, df_2)
# ppe performance
calc_single_perf('mask', 6, df_6)
calc_single_perf('mask', 2, df_2)
#### clear the environment ####
rm(list = ls())
cat("\014")
library(bnlearn)
library(openxlsx)
setwd("C:/Users/squar/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
# setwd("~/OneDrive - North Carolina State University/Research/Code/ABM/BBN/")
source(file = '../../BBN/country_breakdown/functions.R')
source(file = '../../BBN/country_breakdown/package_installation.R')
calc_single_perf <- function(class_var, pmt, df_tot){
if (pmt == 6){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Longitude_1|risk_perception_r][Friends_2|risk_perception_r]",
"[Personal_4|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Trustingroups_7|risk_perception_r][COVIDexp|risk_perception_r]",
"[MediaExp_3|risk_perception_r][KnowledgeCert_2|risk_perception_r]",
"[MediaExp_1|risk_perception_r][Vaccine_1|risk_perception_r]",
"[GenSocTrust|risk_perception_r][DemHealthcare|risk_perception_r]",
"[Trustingroups_2|risk_perception_r][Trustingroups_5|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Personal_7|risk_perception_r]",
"[Soughtinfo|risk_perception_r][MediaExp_5|risk_perception_r]",
"[COVIDeffect_3|risk_perception_r][SARS|risk_perception_r]",
"[Sciunderstand|risk_perception_r][FinitePool_6|risk_perception_r]",
"[Friends_4|risk_perception_r][Trustingroups_1|risk_perception_r]",
"[DemEdu|risk_perception_r][COVIDeffect_4|risk_perception_r]",
"[Govresponse_7|", class_var, "]", "[Govresponse_8|", class_var, "]"))
} else if (pmt == 2){
dag <- model2network(paste0("[", class_var, "][risk_perception_r|", class_var, "]",
"[Govresponse_7|", class_var, "]", "[Govresponse_8|", class_var, "]",
"[CanadaQ_1_7|", class_var, "][COVIDexp|risk_perception_r]",
"[SARS|risk_perception_r][Trustingroups_7|risk_perception_r]",
"[KnowledgeCert_1|risk_perception_r][Trustingroups_6|risk_perception_r]",
"[Friends_1|risk_perception_r][Trustingroups_12|risk_perception_r]",
"[MediaExp_1|risk_perception_r][FinitePool_6|risk_perception_r]",
"[MediaExp_7|risk_perception_r][MediaExp_4|risk_perception_r]",
"[Friends_4|risk_perception_r][COVIDeffect_4|risk_perception_r]"))
}
all_pms <- c('work_from_home', 'dine_out_less', 'shop_groceries_less', 'mask')
pms <- all_pms[!all_pms == class_var]
df_func <- df_tot[,!names(df_tot) %in% pms]
class_level <- '2'
seed <- 218
# print(summary(df_func[class_var]))
# data_tt <- train_test(df_func, target=class_var, train_size=0.7, seed=seed)
cv_list <- cv_partition(df_func, target=class_var, runs=10, k=10, seeds=seed)
# print(cv_list)
# struc_str = paste0("list(model = naive.bayes, args = list(x = train, training = ", "'", class_var, "'))")
# classifier_function = function(t,...) bbn_learning(t, ...)$prediction_fun
bbn_learned <- function(data, target){
fitted = bn.fit(dag, data, method="bayes")
output_fun <- function(data){
# input args of prediction model
args_list <- list(fitted, data=data, node=target, method="bayes-lw", n=100, prob=T)
do.call(predict, args = args_list)
}
return(list(prediction_fun = output_fun, model = fitted))
}
classifier_function <- function(data, ...) bbn_learned(data, ...)$prediction_fun
print(colMeans(cv_evaluation(df_func,
cv_list,
performance_fun = performance_fun,
class_variable = class_var,
class_level = class_level,
classifier_function = classifier_function,
target = class_var)$validation))
# output the current fitted dag in .bif format
write.bif(paste0("./pmt_models/", class_var, "_pmt-", pmt, ".bif"), bbn_learned(df_func, class_var)$model)
# predictive_model <- function(data){
#   prediction <-  attr(learned_model(data),'prob')[class_level,]
# }
#
# print(performance_fun(df_func, predictive_model,
#                       class_variable = class_var,
#                       class_level = class_level))
}
# Read dataset -------------
db <- read.xlsx('data_file_reduced.xlsx')
# remove descriptive rows
db <- db[-c(1:3),]
db <- subset(db, Survey_round == 1)
# predictors
db_x <- data.frame(lapply(db[,1:109], as.factor))
# df_x <- db_x[,c("risk_perception_r","Longitude_1","Friends_2","Trustingroups_7",
# "DemHealthcare","COVIDeffect_4","GenSocTrust","DemEdu","Personal_3",
# "DemGen","Trustingroups_11","Govresponse_7","Govresponse_8")]
db_y <- read.csv("prep_split.csv")
db_y <- data.frame(lapply(db_y[,1:13], as.factor))
colnames(db_y) <- c("Residency",
"Survey_round",
"hand_washing",
"hand_sanitizer",
"mask",
"avoid_social",
"avoid_transit",
"dine_out_less",
"touch_face_less",
"shop_groceries_less",
"cook_home_more",
"work_from_home",
"extra_supplies")
db_y <- subset(db_y, Survey_round == 1)
#### PMT 6 Models ####
# filter db_x so that only the PMT inputs remain.
df_x6 <- db_x[,c("risk_perception_r","Govresponse_7", "Govresponse_8", "Longitude_1",
"Friends_2", "Personal_4", "Trustingroups_6", "Trustingroups_7",
"COVIDexp", "MediaExp_3", "KnowledgeCert_2", "MediaExp_1",
"Vaccine_1", "GenSocTrust", "DemHealthcare", "Trustingroups_2",
"Trustingroups_5", "KnowledgeCert_1", "Personal_7", "Soughtinfo",
"MediaExp_5", "COVIDeffect_3", "SARS", "Sciunderstand",
"FinitePool_6", "Friends_4", "Trustingroups_1", "DemEdu",
"COVIDeffect_4", "Survey_round")]
# add pm variables to df_6 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_6 <- cbind(df_x6, df_y)
df_6 <- cleaning(df_6, threshold=0.12)
df_x2 <- db_x[,c("risk_perception_r", "COVIDexp", "SARS", "Trustingroups_7",
"KnowledgeCert_1", "Trustingroups_6", "Friends_1",
"Trustingroups_12", "MediaExp_1", "FinitePool_6", "MediaExp_7",
"MediaExp_4", "Friends_4", "COVIDeffect_4", "Govresponse_8",
"Govresponse_7", "Survey_round", "CanadaQ_1_7")]
# add pm variables to df_2 and clean the dataset.
df_y <- data.frame(db_y[c('work_from_home', 'dine_out_less', 'shop_groceries_less',
'mask')])
df_2 <- cbind(df_x2, df_y)
df_2 <- cleaning(df_2, threshold=0.12)
#### Calculate PMT 6 and 2 performance of each model ####
# wfh performance
calc_single_perf('work_from_home', 6, df_6)
calc_single_perf('work_from_home', 2, df_2)
# dine performance
calc_single_perf('dine_out_less', 6, df_6)
calc_single_perf('dine_out_less', 2, df_2)
# grocery performance
calc_single_perf('shop_groceries_less', 6, df_6)
calc_single_perf('shop_groceries_less', 2, df_2)
# ppe performance
calc_single_perf('mask', 6, df_6)
calc_single_perf('mask', 2, df_2)
library(bnlearn)
setwd("C:\\Users\\squar\\Documents\\hydraulic_ABM\\Input Files\\pmt_models")
for (i in list.files()){
fitted <- read.bif(i)
out_file <- paste0(substr(i, 1, nchar(i)-3), 'net')
write.net(out_file, fitted)
}
library(bnlearn)
setwd("C:\\Users\\squar\\Documents\\hydraulic_ABM\\Input Files\\pmt_models")
for (i in list.files()){
fitted <- read.bif(i)
out_file <- paste0(substr(i, 1, nchar(i)-3), 'net')
write.net(out_file, fitted)
}
library(bnlearn)
setwd("C:\\Users\\squar\\Documents\\hydraulic_ABM\\Input Files\\pmt_models")
for (i in list.files()){
fitted <- read.bif(i)
out_file <- paste0(substr(i, 1, nchar(i)-3), 'net')
write.net(out_file, fitted)
}
library(bnlearn)
setwd("C:\\Users\\squar\\Documents\\hydraulic_ABM\\Input Files\\pmt_models")
for (i in list.files()){
fitted <- read.bif(i)
out_file <- paste0(substr(i, 1, nchar(i)-3), 'net')
write.net(out_file, fitted)
}
library(bnlearn)
setwd("C:\\Users\\squar\\Documents\\hydraulic_ABM\\Input Files\\pmt_models")
for (i in list.files()){
if (i != 'net_files'){
fitted <- read.bif(i)
out_file <- paste0(substr(i, 1, nchar(i)-3), 'net')
write.net(out_file, fitted)
}
}
